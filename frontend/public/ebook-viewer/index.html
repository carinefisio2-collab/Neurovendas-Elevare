<!DOCTYPE html>
<!--
  ╔═══════════════════════════════════════════════════════════════════════════╗
  ║                    ELEVARE E-BOOK VIEWER                                   ║
  ║                                                                           ║
  ║  Microaplicativo para visualização de e-books com efeito de virar página  ║
  ║  Desenvolvido para integração com a plataforma Elevare NeuroVendas       ║
  ║                                                                           ║
  ║  Suporta: PDF, HTML, Imagens (PNG/JPG)                                   ║
  ║  Versão: 1.0.0                                                            ║
  ╚═══════════════════════════════════════════════════════════════════════════╝
-->
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>E-book Viewer | Elevare</title>
  
  <!-- Estilos do Viewer -->
  <link rel="stylesheet" href="css/viewer.css">
  <link rel="stylesheet" href="css/flipbook.css">
  
  <!-- PDF.js para renderização de PDFs -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
  
  <!-- Preconnect para performance -->
  <link rel="preconnect" href="https://cdnjs.cloudflare.com">
</head>
<body>
  <!-- 
    ═══════════════════════════════════════════════════════════════════════════
    CONTAINER PRINCIPAL
    ═══════════════════════════════════════════════════════════════════════════
  -->
  <div id="ebook-viewer" class="ebook-viewer">
    
    <!-- Header com informações do e-book -->
    <header class="viewer-header">
      <div class="header-left">
        <span class="ebook-title" id="ebook-title">E-book</span>
      </div>
      <div class="header-center">
        <span class="page-indicator" id="page-indicator">Página 1 de 1</span>
      </div>
      <div class="header-right">
        <button class="btn-icon" id="btn-fullscreen" title="Tela cheia" aria-label="Tela cheia">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M8 3H5a2 2 0 0 0-2 2v3m18 0V5a2 2 0 0 0-2-2h-3m0 18h3a2 2 0 0 0 2-2v-3M3 16v3a2 2 0 0 0 2 2h3"/>
          </svg>
        </button>
        <button class="btn-icon" id="btn-bookmark" title="Adicionar marcador" aria-label="Adicionar marcador">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M19 21l-7-5-7 5V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2z"/>
          </svg>
        </button>
      </div>
    </header>

    <!-- Container do Flipbook -->
    <main class="viewer-main">
      <!-- Botão anterior (desktop) -->
      <button class="nav-btn nav-prev" id="btn-prev" aria-label="Página anterior">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <polyline points="15 18 9 12 15 6"/>
        </svg>
      </button>
      
      <!-- Container do livro -->
      <div class="flipbook-container" id="flipbook-container">
        <div class="flipbook" id="flipbook">
          <!-- Páginas serão inseridas dinamicamente aqui -->
        </div>
        
        <!-- Loading overlay -->
        <div class="loading-overlay" id="loading-overlay">
          <div class="loading-spinner"></div>
          <p class="loading-text" id="loading-text">Carregando e-book...</p>
        </div>
      </div>
      
      <!-- Botão próximo (desktop) -->
      <button class="nav-btn nav-next" id="btn-next" aria-label="Próxima página">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <polyline points="9 18 15 12 9 6"/>
        </svg>
      </button>
    </main>

    <!-- Footer com controles -->
    <footer class="viewer-footer">
      <!-- Barra de progresso -->
      <div class="progress-container">
        <div class="progress-bar" id="progress-bar"></div>
      </div>
      
      <!-- Controles mobile -->
      <div class="mobile-controls">
        <button class="mobile-nav-btn" id="mobile-prev" aria-label="Anterior">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <polyline points="15 18 9 12 15 6"/>
          </svg>
          <span>Anterior</span>
        </button>
        
        <div class="page-jump">
          <input type="number" id="page-input" min="1" value="1" aria-label="Ir para página">
          <span class="page-total" id="page-total">/ 1</span>
        </div>
        
        <button class="mobile-nav-btn" id="mobile-next" aria-label="Próxima">
          <span>Próxima</span>
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <polyline points="9 18 15 12 9 6"/>
          </svg>
        </button>
      </div>
    </footer>

    <!-- Painel de bookmarks -->
    <aside class="bookmarks-panel" id="bookmarks-panel">
      <div class="bookmarks-header">
        <h3>Marcadores</h3>
        <button class="btn-close-bookmarks" id="btn-close-bookmarks" aria-label="Fechar">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/>
          </svg>
        </button>
      </div>
      <ul class="bookmarks-list" id="bookmarks-list">
        <!-- Bookmarks serão inseridos dinamicamente -->
      </ul>
    </aside>
  </div>

  <!-- Scripts do Viewer -->
  <script src="js/flipbook-engine.js"></script>
  <script src="js/pdf-renderer.js"></script>
  <script src="js/viewer.js"></script>
  
  <!-- 
    ═══════════════════════════════════════════════════════════════════════════
    INICIALIZAÇÃO
    
    Para usar o viewer, chame ElevareEbookViewer.init() com as opções:
    
    ElevareEbookViewer.init({
      source: 'path/to/ebook.pdf',  // PDF, HTML ou array de imagens
      type: 'pdf',                   // 'pdf', 'html', 'images'
      title: 'Meu E-book',          // Título exibido no header
      container: 'flipbook'         // ID do container (opcional)
    });
    ═══════════════════════════════════════════════════════════════════════════
  -->
  <script>
    // Inicialização automática via URL params ou postMessage
    document.addEventListener('DOMContentLoaded', function() {
      // Verificar parâmetros da URL
      const params = new URLSearchParams(window.location.search);
      const source = params.get('source');
      const type = params.get('type') || 'pdf';
      const title = params.get('title') || 'E-book';
      
      if (source) {
        ElevareEbookViewer.init({
          source: decodeURIComponent(source),
          type: type,
          title: decodeURIComponent(title)
        });
      }
      
      // Escutar mensagens do parent (para integração iframe)
      window.addEventListener('message', function(event) {
        if (event.data && event.data.action === 'loadEbook') {
          ElevareEbookViewer.init({
            source: event.data.source,
            type: event.data.type || 'pdf',
            title: event.data.title || 'E-book'
          });
        }
      });
    });
  </script>
</body>
</html>
